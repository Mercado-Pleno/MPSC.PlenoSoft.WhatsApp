<html>
	<head>
		<title>WhatsApp Self Link Generator</title>
		<meta name="description" content="Gerador de link para enviar mensagem para você mesmo">
		<meta name="keywords" content="WhatsApp Self Link Generator Gerador Zap Whats App WA">
		<meta name="robots" content="">
		<meta name="revisit-after" content="1 month">
		<meta name="language" content="Portuguese">
		<meta name="generator" content="N/A">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body style="background-color: rgb(226, 238, 224)">
		<div align="center">
			<span style="width: 256px; text-align: center; display: inline-block;">
				<h1>WhatsApp</h1>
				Envie mensagens para qualquer número do Whats App, inclusive para o seu próprio número!
				<br /><br />
				E o melhor, você não precisa que o número esteja em sua agenda!
			</span>
			<br />
			<br />
			<label for="ddi" style="width: 48px; text-align: left; display: inline-block;">DDI: </label>
			<label for="ddd" style="width: 48px; text-align: left; display: inline-block;">DDD: </label>
			<label for="phone" style="width: 154px; text-align: left; display: inline-block;">Telefone: </label>
			<br />
			<input type="text" id="ddi" name="ddi" value="55" onchange="changeLink()" style="width: 48px;" maxlength="2" />
			<input type="text" id="ddd" name="ddd" value="21" onchange="changeLink()" style="width: 48px;" maxlength="2" />
			<input type="text" id="phone" name="phone" value="" onchange="changeLink()" style="width: 154px;" maxlength="20" />
			<br />
			<br />
			<label for="msg" style="width: 250px; text-align: left; display: inline-block;">Mensagem: </label>
			<br />
			<textarea type="text" id="msg" name="msg" onkeyup="changeLink()" style="width: 256px;" rows="8">https://bruno-n-fernandes.github.io/MPSC.PlenoSoft.WhatsApp</textarea>
			<br />
			<br />
			Enviar Mensagem para<br />
			<a id="link" name="link" target="WhatsApp">
				<span for="qrCode" id="lbLink" name="lbLink"></span>
				<br />
				<img id="qrCode" name="qrCode" width="256" height="256" src="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=https://bruno-n-fernandes.github.io/MPSC.PlenoSoft.WhatsApp" />
			</a>
			<br />
			<h3>Projeto hospedado no <a href="https://github.com/Bruno-N-Fernandes/MPSC.PlenoSoft.WhatsApp">Git Hub</a></h3>
			<h4>Desenvolvido por <a href="https://instagram.com/HipnoseDivertida">@HipnoseDivertida</a></h4>
		</div>
		<script type="text/javascript">

			const txtddi = document.getElementById("ddi");
			const txtddd = document.getElementById("ddd");
			const txtphone = document.getElementById("phone");
			const txtmsg = document.getElementById("msg");
			const link = document.getElementById("link");
			const lbLink = document.getElementById("lbLink");
			const qrCode = document.getElementById("qrCode");

			const insert = function insert(main_string, ins_string, pos) {
				if (typeof(pos) == "undefined") {
					pos = 0;
				}
				if (typeof(ins_string) == "undefined") {
					ins_string = '';
				}
				return main_string.slice(0, pos) + ins_string + main_string.slice(pos);
			}

			function changeLink() {
				let number = txtphone.value.replace(/[^0-9]/gi, "");

				if (number.length == 0) return;

				if (number.length >= 12) {
					txtddi.value = number.substring(0, 2);
					number = number.substring(2);
				}

				if (number.length >= 10) {
					txtddd.value = number.substring(0, 2);
					number = number.substring(2);
				}

				let phone = insert(number, "-", -4);
				if (number.length == 9) {
					phone = insert(phone, " ", 1);
				}

				txtphone.value = phone;
				let ddi = txtddi.value.trim();
				let ddd = txtddd.value.trim();
				let fullPhone = `+${ddi} (${ddd}) ${phone}`;
				let fullNumber = ddi + ddd + number;
				let mensagem = encodeURIComponent(txtmsg.value.trim());
				let waUrl = `https://api.whatsapp.com/send?phone=${fullNumber}&text=${mensagem}`;

				link.href = waUrl;
				lbLink.innerText = fullPhone;
				qrCode.src = `https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=${encodeURIComponent(waUrl)}`;
			}

			const queryString = new URLSearchParams(window.location.search);
			txtphone.value = queryString.get("phone");
			txtmsg.value = queryString.has("msg") ? queryString.get("msg") : txtmsg.value;

			changeLink();
		</script>
	</body>
</html>
